import { Tileset } from "../../../artTypes/world";
import { PhaserLayer } from "../createPhaserLayer";
import { createNoise2D } from "simplex-noise";

const LAYER1 = [
  [
    49, 49, 49, 49, 49, 49, 37, 17, 17, 17, 17, 36, 49, 49, 49, 49, 37, 37, 98,
    98, 98,
  ],
  [
    81, 81, 81, 81, 81, 81, 32, 4, 5, 17, 17, 19, 128, 129, 129, 129, 131, 82,
    82, 82, 98,
  ],
  [
    81, 0, 1, 2, 3, 81, 32, 20, 21, 17, 17, 98, 144, 145, 145, 145, 147, 82, 82,
    82, 82,
  ],
  [
    81, 16, 17, 17, 19, 81, 32, 17, 17, 17, 98, 98, 144, 145, 145, 145, 147, 82,
    82, 82, 82,
  ],
  [
    81, 32, 17, 17, 19, 81, 32, 17, 17, 98, 98, 98, 144, 145, 145, 145, 147, 82,
    82, 82, 82,
  ],
  [
    81, 48, 49, 50, 51, 81, 32, 17, 17, 17, 98, 98, 144, 145, 145, 145, 147, 82,
    82, 82, 82,
  ],
  [
    81, 81, 81, 81, 81, 81, 32, 17, 17, 17, 17, 19, 144, 145, 145, 145, 147, 82,
    82, 82, 82,
  ],
  [
    1, 1, 1, 1, 1, 1, 36, 5, 18, 18, 18, 98, 144, 145, 145, 145, 163, 82, 82,
    82, 82,
  ],
  [
    18, 18, 18, 18, 18, 18, 20, 21, 18, 18, 18, 19, 176, 177, 178, 178, 179, 82,
    82, 82, 82,
  ],
  [
    18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 18, 82, 82, 82, 82, 82, 82, 82,
    82, 82,
  ],
  [
    17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 98, 82, 82, 82, 82, 82, 82, 82,
    82, 82,
  ],
  [
    17, 17, 17, 17, 17, 17, 17, 17, 17, 98, 98, 98, 82, 82, 82, 82, 82, 82, 82,
    82, 82,
  ],
  [
    17, 17, 17, 17, 17, 17, 17, 98, 98, 98, 56, 57, 58, 98, 98, 98, 98, 98, 98,
    98, 98,
  ],
  [
    -1, -1, -1, -1, -1, -1, 98, 98, 98, 98, 72, 73, 74, 81, 81, 81, 81, -1, -1,
    81, 81,
  ],
  [
    -1, -1, -1, -1, -1, -1, -1, 98, 98, 98, 98, 98, 81, 81, 81, 81, 81, 81, 81,
    81, 81,
  ],
  [
    -1, -1, -1, -1, -1, -1, -1, -1, 98, 98, 98, 98, 98, 81, 81, 81, 81, 81, 81,
    81, 81,
  ],
];

const LAYER_WIDTH = 21;
const LAYER_HEIGHT = 21;

export function createMapSystem(layer: PhaserLayer) {
  const {
    scenes: {
      Main: {
        maps: {
          Main: { putTileAt },
        },
      },
    },
  } = layer;

  // for (let x = 0; x <= 21; x++) {
  //   for (let y = 0; y <= 21; y++) {
  //     const coord = { x, y };
  //     console.log(coord, LAYER1);
  //     const spriteNr = LAYER1[y][x];
  //     console.log({ x, y }, spriteNr);

  //     if (LAYER1[y][x]) {
  //       putTileAt(coord, spriteNr, "Foreground");
  //     }
  //   }
  // }
  const noise = createNoise2D();

  for (let x = -500; x < 500; x++) {
    for (let y = -500; y < 500; y++) {
      const coord = { x, y };
      const seed = noise(x, y);

      putTileAt(coord, Tileset.Grass, "Background");

      if (seed >= 0.45) {
        putTileAt(coord, Tileset.Mountain, "Foreground");
      } else if (seed < -0.45) {
        putTileAt(coord, Tileset.Forest, "Foreground");
      }
    }
  }
}
